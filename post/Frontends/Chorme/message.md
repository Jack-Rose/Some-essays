# message event

## 使用单线程处理安排好的任务

> 顺序执行，直到推出

## 在线程运行过程中处理新任务

> 引入了循环机制、事件

## 处理其他线程发送过来的任务

> 消息队列

### 消息队列

>消息队列是一种数据结构，可以存放要执行的任务。它符合队列“先进先出”的特点，也就是说要添加任务的话，添加到队列的尾部；要取出任务的话，从队列头部去取。

#### 构建消息队列模型

1. 添加一个消息队列；
2. IO 线程中产生的新任务添加进消息队列尾部；
3. 渲染主线程会循环地从消息队列头部中读取任务，执行任务

## 处理其他进程发送过来的任务

> 进程之间都有专用的进行，渲染进程专门有一个 IO 线程用来接收其他进程传进来的消息

## 消息队列中的任务类型

> 输入事件（鼠标滚动、点击、移动）、微任务、文件读写、WebSocket、JavaScript 定时器.
> 页面相关的事件 JavaScript 执行、解析 DOM、样式计算、布局计算、CSS 动画等.

## 如何安全退出主线程

> Chrome 是这样解决的，确定要退出当前页面时，页面主线程会设置一个退出标志的变量，在每次执行完一个任务时，判断是否有设置退出标志

## 页面使用单线程的缺点