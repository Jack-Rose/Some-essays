# CSRF

> `CSRF` 英文全称是 `Cross-site request forgery`，所以又称为“跨站请求伪造”，是指黑客引诱用户打开黑客的网站，在黑客的网站中，利用用户的登录状态发起的跨站请求。

## 实施 `CSRF` 攻击

> 和 XSS 不同的是，`CSRF` 攻击不需要将恶意代码注入用户的页面，仅仅是利用服务器的漏洞和用户的登录状态来实施攻击。

1. 自动发起 Get 请求
2. 自动发起 POST 请求
3. 引诱用户点击链接

## 如何防止 CSRF 攻击

### 发起 CSRF 攻击的三个必要条件

1. 目标站点一定要有 CSRF 漏洞；
2. 用户要登录过目标站点，并且在浏览器上保持有该站点的登录状态；
3. 需要用户打开一个第三方站点，可以是黑客的站点，也可以是一些论坛;

### 避免遭受到 CSRF 攻击，通常有以下几种途径

#### 充分利用好 `Cookie` 的 SameSite 属性

> `Cookie` 正是浏览器和服务器之间维护登录状态的一个关键数据

1. 如果是从第三方站点发起的请求，那么需要浏览器禁止发送某些关键 Cookie 数据到服务器；
2. 如果是同一个站点发起的请求，那么就需要保证 Cookie 数据正常发送

`SameSite` 选项通常有 `Strict、Lax` 和 `None` 三个值

#### 验证请求的来源站点

> `Referer` 是 HTTP 请求头中的一个字段，记录了该 `HTTP` 请求的来源地址

#### CSRF Token

1. 在浏览器向服务器发起请求时，服务器生成一个 `CSRF Token`。
2. 在浏览器端如果要发起转账的请求，那么需要带上页面中的 `CSRF Token`，然后服务器会验证该 `Token` 是否合法。
